work(){
    export SIRI_WORKDIR=$(pwd)
}

zg() {
    cd $SIRI_WORKDIR
}

# alias ka="echo -e '\033[32m'; cat ka.sh | grep -v '#' | head -n1; echo -e '\033[0m'"
ka(){ if [ -z "$VM_NAME" ]; then echo "no ka is set"; return 1; fi; echo -e "\033[32m${VM_NAME}\033[0m"; }

zzz(){
    if [[ $1 == k ]]; then
	    if [ -z "$2" ]; then echo "no ka provided"; return 1; fi;
	    echo removing $2
	    sudo rm /kmh-nfs-us-mount/staging/.sscript/$2
    fi

    # show all vm_name -> command pairs
    for folder in /kmh-nfs-us-mount/staging/.sscript/*; do
        vm_name=$(basename $folder)
        command=$(cat $folder/command 2>/dev/null || echo "NO COMMAND FOUND")

        # highlight command
        # for str like *staging/\w+/(\w+)/launch*, highlight the (\w+)
        command=$(echo $command | sed -E 's#(staging/\w+/)(\w+)(/launch)#\1\\033[33m\2\\033[0m\3#g')
        status=$((cat /kmh-nfs-us-mount/staging/.sscript/$vm_name/status 2>/dev/null || echo "UNKNOWN") | sed -E 's/STARTED/\\033[34m&\\033[0m/g' | sed -E 's/FAILED/\\033[31m&\\033[0m/g' | sed -E 's/FINISHED/\\033[32m&\\033[0m/g')

        echo -e "\n[$status] \033[1m$vm_name\033[0m -> $command\n"
    done;
}

# main alias
alias zhh="/kmh-nfs-us-mount/code/siri/scripts/main.sh"

